<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KazandÄ±ran FinansÃ§Ä± - Pro Crash</title>
    <style>
        /* CSS Kodu - DeÄŸiÅŸmedi */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #0d1e3a; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #fff;
        }
        .oyun-container {
            width: 800px;
            max-width: 95%;
            background-color: #0f274a;
            border: 4px solid #1e90ff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 30px rgba(30, 144, 255, 0.5);
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #1e90ff;
        }
        .title {
            font-size: 32px;
            font-weight: bold;
            color: #00ff7f;
            text-shadow: 0 0 5px #00ff7f;
        }
        .bakiye {
            font-size: 24px;
            color: #fff;
            background-color: #0f274a;
            padding: 5px 10px;
            border-radius: 5px;
            border: 1px solid #1e90ff;
        }

        .grafik-alani {
            position: relative;
            height: 350px;
            background-color: #0a1728;
            border: 2px solid #00ff7f;
            border-radius: 8px;
            margin-bottom: 20px;
            /* Grid Deseni */
            background-image: 
                linear-gradient(rgba(26, 61, 109, 0.5) 1px, transparent 1px),
                linear-gradient(90deg, rgba(26, 61, 109, 0.5) 1px, transparent 1px);
            background-size: 50px 50px;
            overflow: hidden;
        }
        .carpan-gosterge {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 64px;
            font-weight: 800;
            color: #00ff7f;
            text-shadow: 0 0 20px rgba(0, 255, 127, 0.4);
            z-index: 10;
            font-variant-numeric: tabular-nums; /* SayÄ±larÄ±n titremesini engeller */
        }
        .carpan-gosterge.crash {
            color: #ff4d4d; 
            text-shadow: 0 0 20px rgba(255, 77, 77, 0.6);
        }

        #grafikCanvas {
            position: absolute;
            top: 0;
            left: 0;
        }

        .kontrol-paneli {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        .hiz-ayarlari {
            grid-column: 1 / span 3;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        .hiz-ayarlari button {
            background-color: #1e3d6d;
            color: #fff;
            padding: 8px 15px;
            border: 1px solid #1e90ff;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .hiz-ayarlari button:hover { background-color: #1a5c96; }
        .hiz-ayarlari .aktif { background-color: #1e90ff; border-color: #fff; font-weight: bold; }

        .sonuclar-alani {
            background-color: #0a1728;
            border: 2px solid #1e90ff;
            border-radius: 5px;
            padding: 10px;
            height: 150px;
            overflow-y: auto;
            display: flex;
            flex-direction: column; 
        }
        .sonuclar-alani h3 {
            margin-top: 0;
            color: #00ff7f;
            border-bottom: 1px solid #1e90ff;
            padding-bottom: 5px;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .sonuclar-liste {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        .sonuc-item {
            background-color: #4b0082;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 13px;
            font-weight: bold;
        }
        .sonuc-item.kayip { background-color: #3d0d0d; color: #ff6666; border: 1px solid #ff4d4d; }
        .sonuc-item.kazanc { background-color: #0d3d1e; color: #66ff99; border: 1px solid #00ff7f; }

        .bahis-kontrol, .oyun-butonlari {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .bahis-butonlari {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }
        .bahis-butonlari button {
            background-color: #333;
            color: #fff;
            padding: 10px 0;
            border: 1px solid #666;
            border-radius: 5px;
            cursor: pointer;
        }
        .bahis-secim { display: flex; gap: 5px; }
        .bahis-secim button {
            flex-grow: 1;
            padding: 10px 0;
            font-size: 16px;
            background-color: #1e3d6d;
            border: 1px solid #1e90ff;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }

        #oynaToplaBtn {
            background-color: #00cc66; 
            color: white;
            padding: 20px;
            border: none;
            border-radius: 8px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px #00994d;
            transition: transform 0.1s, box-shadow 0.1s;
        }
        #oynaToplaBtn:active { box-shadow: 0 2px #00994d; transform: translateY(3px); }
        #oynaToplaBtn.topla-modu { background-color: #ffaa00; box-shadow: 0 5px #cc8800; }
        #oynaToplaBtn.topla-modu:active { box-shadow: 0 2px #cc8800; }

        .oto-strateji {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        #otoStratejiSwitch {
            width: 60px;
            height: 30px;
            background-color: #333;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.4s;
        }
        #otoStratejiSwitch.on { background-color: #1e90ff; }
        #otoStratejiSwitch .slider {
            width: 26px;
            height: 26px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.4s;
        }
        #otoStratejiSwitch.on .slider { transform: translateX(30px); }
        .not {
            grid-column: 1 / span 3;
            font-size: 11px;
            color: #8899aa;
            text-align: center;
            margin-top: 5px;
        }
    </style>
</head>
<body>

<div class="oyun-container">

    <div class="header">
        <div class="title">ðŸš€ KAZANDIRAN FÄ°NANSÃ‡I</div>
        <div class="bakiye" id="bakiyeGosterge">â‚º100.00</div>
    </div>

    <div class="grafik-alani">
        <div class="carpan-gosterge" id="carpanGosterge">1.00x</div>
        <canvas id="grafikCanvas"></canvas>
    </div>

    <div class="hiz-ayarlari">
        <span style="font-weight: bold;">HIZ:</span>
        <button onclick="setHiz(0.5)">0.50x</button>
        <button class="aktif" onclick="setHiz(1.0)">1.00x</button>
        <button onclick="setHiz(2.0)">2.00x</button>
        <button onclick="setHiz(5.0)">5.00x</button>
    </div>

    <div class="kontrol-paneli">
        <div class="sonuclar-alani">
            <h3>SONUÃ‡LAR</h3>
            <div class="sonuclar-liste" id="sonuclarListesi">
                </div>
        </div>

        <div class="bahis-kontrol">
            <div class="bahis-secim">
                <button onclick="ayarlaBahis(-10)">-</button>
                <button style="flex-grow: 2;" id="aktifBahisGosterge">â‚º10.00</button>
                <button onclick="ayarlaBahis(10)">+</button>
            </div>

            <div class="bahis-butonlari">
                <button onclick="setBahis(10)">â‚º10</button>
                <button onclick="setBahis(20)">â‚º20</button>
                <button onclick="setBahis(50)">â‚º50</button>
                <button onclick="setBahis(100)">â‚º100</button>
            </div>
        </div>

        <div class="oyun-butonlari">
            <button id="oynaToplaBtn" onclick="oynaVeyaTopla()">OYNA</button>
            <div class="oto-strateji">
                <div id="otoStratejiSwitch"><div class="slider"></div></div>
                <span style="font-size: 12px;">OTO STRATEJÄ°</span>
            </div>
        </div>

        <div class="not">
            Tur baÅŸladÄ±ktan sonra dahil olunan oyunlar, kazanÃ§larda %32 kesintiye tabidir. Max KazanÃ§: â‚º10.000.000
        </div>
    </div>
</div>

<script>
    // --- OYUN AYARLARI ---
    const TARGET_RTP = 0.70; // %70 RTP
    const HOUSE_EDGE = 1 - TARGET_RTP; // %30 Kasa AvantajÄ±
    const MAX_KAZANC = 10000000.00;
    
    // DeÄŸiÅŸkenler
    let bakiye = 100.00;
    let aktifBahis = 10.00;
    let oyunDurumu = 'bekliyor'; // 'bekliyor', 'oynuyor', 'bitti'
    let mevcutCarpan = 1.00;
    let hedeflenenCrashNoktasi = 0;
    let baslangicZamani = 0;
    let oyunHiziCarpani = 1.0; 
    let animasyonFrameId;
    let grafikVerisi = [];

    // DOM Elementleri
    const uiBakiye = document.getElementById('bakiyeGosterge');
    const uiBahis = document.getElementById('aktifBahisGosterge');
    const uiCarpan = document.getElementById('carpanGosterge');
    const uiBtn = document.getElementById('oynaToplaBtn');
    const uiListe = document.getElementById('sonuclarListesi');
    const canvas = document.getElementById('grafikCanvas');
    const ctx = canvas.getContext('2d');

    // Canvas BoyutlandÄ±rma
    function resizeCanvas() {
        const parent = canvas.parentElement;
        canvas.width = parent.clientWidth;
        canvas.height = parent.clientHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // --- TEMEL FONKSÄ°YONLAR ---

    function updateUI() {
        uiBakiye.textContent = `â‚º${bakiye.toFixed(2)}`;
        uiBahis.textContent = `â‚º${aktifBahis.toFixed(2)}`;
    }

    function setBahis(miktar) {
        if (oyunDurumu === 'oynuyor') return;
        aktifBahis = Math.min(100, Math.max(10, miktar));
        updateUI();
    }

    function ayarlaBahis(delta) {
        setBahis(aktifBahis + delta);
    }

    function setHiz(x) {
        if(oyunDurumu === 'oynuyor') return;
        oyunHiziCarpani = x;
        // Buton stillerini gÃ¼ncelle
        document.querySelectorAll('.hiz-ayarlari button').forEach(b => b.classList.remove('aktif'));
        event.target.classList.add('aktif');
    }

    // --- KRÄ°TÄ°K OYUN MATEMATÄ°ÄžÄ° ---

    // Bu formÃ¼l "Bustabit" tarzÄ± oyunlarÄ±n standart formÃ¼lÃ¼dÃ¼r.
    // %70 RTP iÃ§in ayarlanmÄ±ÅŸtÄ±r.
    function crashNoktasiUret() {
        // 0 ile 1 arasÄ±nda rastgele sayÄ±
        const r = Math.random();
        
        // FormÃ¼l: Kasa AvantajÄ± / (1 - r)
        // Ã–rnek: r=0.99 gelirse -> 0.30 / 0.01 = 30x
        // Ã–rnek: r=0.01 gelirse -> 0.30 / 0.99 = 0.30x (Ama oyun min 1.00x olduÄŸu iÃ§in crash olur)
        
        let crash = TARGET_RTP / (1 - r);
        
        // Crash noktasÄ± 1.00'dan kÃ¼Ã§Ã¼kse anÄ±nda patlar (Instant Bust)
        // Ama gÃ¶rsel olarak 1.00x'i gÃ¶stermek iÃ§in bunu hesaplÄ±yoruz.
        if (crash < 1.00) crash = 1.00;

        return Math.floor(crash * 100) / 100; // 2 basamak yuvarla
    }

    // Ã‡arpanÄ± hesaplayan fonksiyon (Ãœstel BÃ¼yÃ¼me - Exponential Growth)
    // t: geÃ§en saniye
    function carpanHesapla(saniye) {
        // BÃ¼yÃ¼me formÃ¼lÃ¼: e^(k * t)
        // k=0.06 yaklaÅŸÄ±k 10 saniyede 2x'e, 20 saniyede 4x'e Ã§Ä±karÄ±r.
        const k = 0.06 * oyunHiziCarpani; 
        return Math.pow(Math.E, k * saniye);
    }

    // --- OYUN DÃ–NGÃœSÃœ ---

    function oyunuBaslat() {
        if (bakiye < aktifBahis) {
            alert("Yetersiz Bakiye!");
            return;
        }

        // Reset
        oyunDurumu = 'oynuyor';
        bakiye -= aktifBahis;
        updateUI();
        
        mevcutCarpan = 1.00;
        grafikVerisi = [];
        
        // Crash NoktasÄ±nÄ± Belirle (Ã–nceden belirlenir ama kullanÄ±cÄ± bilmez)
        hedeflenenCrashNoktasi = crashNoktasiUret();
        
        // Konsola hile testi iÃ§in yazalÄ±m (GeliÅŸtirici gÃ¶rsÃ¼n)
        console.log("Hedef Crash:", hedeflenenCrashNoktasi);

        // UI HazÄ±rlÄ±ÄŸÄ±
        uiBtn.textContent = "TOPLA";
        uiBtn.classList.add('topla-modu');
        uiCarpan.textContent = "1.00x";
        uiCarpan.classList.remove('crash');
        uiCarpan.style.color = "#00ff7f";
        
        baslangicZamani = Date.now();
        animasyonFrameId = requestAnimationFrame(oyunDongusu);
    }

    function oyunDongusu() {
        if (oyunDurumu !== 'oynuyor') return;

        // GeÃ§en sÃ¼reyi hesapla (Milisaniye -> Saniye)
        const simdi = Date.now();
        const gecenSaniye = (simdi - baslangicZamani) / 1000;

        // Yeni Ã§arpanÄ± hesapla
        mevcutCarpan = carpanHesapla(gecenSaniye);

        // 1. Crash KontrolÃ¼
        if (mevcutCarpan >= hedeflenenCrashNoktasi) {
            oyunuBitir(false); // Kaybettin (PatladÄ±)
            return;
        }

        // 2. Max KazanÃ§ KontrolÃ¼ (Zorunlu Toplama)
        if ((mevcutCarpan * aktifBahis) >= MAX_KAZANC) {
            oyunuBitir(true); // Otomatik kazandÄ±
            return;
        }

        // Grafik Verisi Ekle
        grafikVerisi.push(mevcutCarpan);
        if(grafikVerisi.length > 300) grafikVerisi.shift(); // HafÄ±za yÃ¶netimi

        // EkranÄ± GÃ¼ncelle
        uiCarpan.textContent = mevcutCarpan.toFixed(2) + "x";
        grafigiCiz();

        // DÃ¶ngÃ¼ye devam et
        animasyonFrameId = requestAnimationFrame(oyunDongusu);
    }

    function oyunuBitir(kazandi) {
        oyunDurumu = 'bitti';
        cancelAnimationFrame(animasyonFrameId);
        
        uiBtn.textContent = "OYNA";
        uiBtn.classList.remove('topla-modu');

        let sonucDegeri = kazandi ? mevcutCarpan : hedeflenenCrashNoktasi;
        
        if (kazandi) {
            // KazanÃ§ Hesapla
            let brutKazanc = aktifBahis * mevcutCarpan;
            let netKazanc = brutKazanc * 0.68; // %32 Kesinti
            bakiye += netKazanc;
            
            uiCarpan.style.color = "#00ff7f"; // YeÅŸil
            sonucEkle(mevcutCarpan, true);
        } else {
            // KayÄ±p (Crash)
            uiCarpan.textContent = hedeflenenCrashNoktasi.toFixed(2) + "x";
            uiCarpan.classList.add('crash'); // KÄ±rmÄ±zÄ± & Efekt
            uiCarpan.style.color = "#ff4d4d";
            
            // Grafik sonunu Ã§iz
            grafikVerisi.push(0); // DÃ¼ÅŸÃ¼ÅŸ efekti iÃ§in
            grafigiCiz();
            
            sonucEkle(hedeflenenCrashNoktasi, false);
        }
        
        updateUI();
    }

    function oynaVeyaTopla() {
        if (oyunDurumu === 'bekliyor' || oyunDurumu === 'bitti') {
            oyunuBaslat();
        } else if (oyunDurumu === 'oynuyor') {
            // Topla butonuna basÄ±ldÄ±
            if (mevcutCarpan > 1.00) {
                oyunuBitir(true);
            }
        }
    }

    // --- GRAFÄ°K Ã‡Ä°ZÄ°MÄ° (EÄžRÄ°SEL) ---
    function grafigiCiz() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        if (grafikVerisi.length < 2) return;

        ctx.beginPath();
        ctx.lineWidth = 4;
        ctx.lineCap = "round";
        ctx.lineJoin = "round";

        // Ã‡izgi Rengi (Duruma gÃ¶re)
        if (oyunDurumu === 'bitti' && uiCarpan.classList.contains('crash')) {
            ctx.strokeStyle = "#ff4d4d"; // KÄ±rmÄ±zÄ±
        } else {
            ctx.strokeStyle = "#00ff7f"; // YeÅŸil
        }

        // Koordinat Hesaplama
        // X ekseni: Zaman (Veri sayÄ±sÄ±)
        // Y ekseni: Ã‡arpan (Logaritmik veya Lineer Ã¶lÃ§ekleme yapÄ±labilir, burada basit oranlama yapÄ±yoruz)
        
        // Dinamik Ã–lÃ§ekleme: GrafiÄŸin en yÃ¼ksek deÄŸeri her zaman canvas'Ä±n %10'u kadar boÅŸluk bÄ±rakÄ±r
        let maxVal = Math.max(...grafikVerisi, 2.0); // En az 2.0x tavanÄ± olsun
        
        const widthStep = canvas.width / (grafikVerisi.length - 1);
        
        grafikVerisi.forEach((val, index) => {
            let x = index * widthStep;
            
            // Y ekseni ters (0,0 sol Ã¼sttÃ¼r). DeÄŸeri normalleÅŸtiriyoruz.
            // val=1.00 -> En alt (canvas.height)
            // val=maxVal -> En Ã¼st
            
            // EÄŸer crash olduysa son deÄŸer 0'dÄ±r, onu en alta Ã§ekelim
            if (val === 0) val = 1.0; 

            let normalizedY = (val - 1.0) / (maxVal - 1.0); // 0 ile 1 arasÄ±
            let y = canvas.height - (normalizedY * (canvas.height * 0.8)) - 20; // 20px alt boÅŸluk

            if (index === 0) ctx.moveTo(x, y);
            else ctx.lineTo(x, y);
        });

        ctx.stroke();
        
        // AlanÄ± doldur (Gradient)
        ctx.lineTo(canvas.width, canvas.height);
        ctx.lineTo(0, canvas.height);
        ctx.closePath();
        
        const gradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
        if (oyunDurumu === 'bitti' && uiCarpan.classList.contains('crash')) {
            gradient.addColorStop(0, "rgba(255, 77, 77, 0.5)");
            gradient.addColorStop(1, "rgba(255, 77, 77, 0.0)");
        } else {
            gradient.addColorStop(0, "rgba(0, 255, 127, 0.5)");
            gradient.addColorStop(1, "rgba(0, 255, 127, 0.0)");
        }
        ctx.fillStyle = gradient;
        ctx.fill();
    }

    // SonuÃ§ Listesi YÃ¶netimi
    function sonucEkle(deger, kazandi) {
        const div = document.createElement('div');
        div.className = `sonuc-item ${kazandi ? 'kazanc' : 'kayip'}`;
        div.textContent = deger.toFixed(2) + 'x';
        
        // BaÅŸa ekle
        uiListe.prepend(div);
        
        // Max 15 sonuÃ§ tut
        if (uiListe.children.length > 15) {
            uiListe.lastElementChild.remove();
        }
    }

    // BaÅŸlangÄ±Ã§ AyarlarÄ±
    updateUI();
</script>

</body>
</html>
