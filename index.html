<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZENGÄ°N DEDE - Crash Game</title>
    <style>
        /* BASE CSS */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #0d1e3a; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; color: #fff; }
        .oyun-container { width: 800px; max-width: 95%; background-color: #0f274a; border: 4px solid #1e90ff; border-radius: 10px; padding: 20px; box-shadow: 0 0 30px rgba(30, 144, 255, 0.5); position: relative; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #1e90ff; }
        .title { font-size: 32px; font-weight: bold; color: #00ff7f; text-shadow: 0 0 5px #00ff7f; }
        .bakiye { font-size: 24px; color: #fff; background-color: #0f274a; padding: 5px 10px; border-radius: 5px; border: 1px solid #1e90ff; margin-right: 50px; }
        
        .grafik-alani { position: relative; height: 350px; background-color: #0a1728; border: 2px solid #00ff7f; border-radius: 8px; margin-bottom: 20px; background-image: linear-gradient(rgba(26, 61, 109, 0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(26, 61, 109, 0.3) 1px, transparent 1px); background-size: 40px 40px; overflow: hidden; }
        
        /* GÃ–STERGE TASARIMI */
        .carpan-gosterge { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); font-size: 56px; font-weight: 800; color: #00ff7f; text-shadow: 0 0 20px rgba(0, 255, 127, 0.4); z-index: 10; background-color: rgba(10, 23, 40, 0.7); padding: 5px 20px; border-radius: 10px; border: 1px solid #1e90ff; font-variant-numeric: tabular-nums; transition: all 0.1s ease; }
        .carpan-gosterge.crash { 
            color: #ff0040; 
            text-shadow: 0 0 20px #ff0040; 
            border: 3px solid #ff0040; 
            background-color: rgba(50, 0, 0, 0.85);
            box-shadow: 0 0 40px rgba(255, 0, 64, 0.4);
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translateX(-51%); }
            20%, 80% { transform: translateX(-49%); }
            30%, 50%, 70% { transform: translateX(-51%); }
            40%, 60% { transform: translateX(-49%); }
        }

        #grafikCanvas { position: absolute; top: 0; left: 0; transition: transform 0.1s ease-out; } 
        
        /* KONTROL PANELÄ° (MasaÃ¼stÃ¼ DÃ¼zeni) */
        .kontrol-paneli { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
        .hiz-ayarlari { grid-column: 1 / span 3; display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .hiz-ayarlari button { background-color: #1e3d6d; color: #fff; padding: 8px 15px; border: 1px solid #1e90ff; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; }
        .hiz-ayarlari button:hover { background-color: #1a5c96; }
        .hiz-ayarlari .aktif { background-color: #1e90ff; border-color: #fff; font-weight: bold; }
        
        /* SONUÃ‡LAR ALANI (MasaÃ¼stÃ¼) */
        .sonuclar-alani { 
            background-color: #0a1728; 
            border: 2px solid #1e90ff; 
            border-radius: 5px; 
            padding: 10px; 
            height: 150px; 
            overflow-y: auto; 
            grid-column: 1; 
        }
        .sonuclar-liste { display: flex; flex-wrap: wrap; gap: 5px; }
        .sonuc-item { background-color: #4b0082; padding: 4px 8px; border-radius: 4px; font-size: 13px; font-weight: bold; }
        .sonuc-item.kayip { background-color: #3d0d0d; color: #ff6666; border: 1px solid #ff4d4d; }
        .sonuc-item.kazanc { background-color: #0d3d1e; color: #66ff99; border: 1px solid #00ff7f; }

        /* BAHÄ°S VE OYNA BUTONLARI */
        .bahis-kontrol { 
            display: flex; 
            flex-direction: column; 
            gap: 8px; 
            grid-column: 2; 
        }
        .bahis-butonlari { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        .bahis-butonlari button { background-color: #333; color: #fff; padding: 10px 0; border: 1px solid #666; border-radius: 5px; cursor: pointer; }
        .bahis-secim { display: flex; gap: 5px; }
        .bahis-secim button { flex-grow: 1; padding: 10px 0; font-size: 16px; background-color: #1e3d6d; border: 1px solid #1e90ff; color: #fff; border-radius: 5px; cursor: pointer; }
        .oyun-butonlari { 
            display: flex; 
            flex-direction: column; 
            gap: 8px;
            grid-column: 3; 
        }
        #oynaToplaBtn { background-color: #00cc66; color: white; padding: 20px; border: none; border-radius: 8px; font-size: 24px; font-weight: bold; cursor: pointer; box-shadow: 0 5px #00994d; }
        #oynaToplaBtn:active { box-shadow: 0 2px #00994d; transform: translateY(3px); }
        #oynaToplaBtn.topla-modu { background-color: #ffaa00; box-shadow: 0 5px #cc8800; }
        #oynaToplaBtn.topla-modu:active { box-shadow: 0 2px #cc8800; }
        #oynaToplaBtn:disabled { opacity: 0.6; cursor: not-allowed; }

        /* OTO AYARLAR */
        .oto-ayarlar { grid-column: 1 / span 3; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; padding: 10px; border: 1px dashed #1e90ff; border-radius: 8px; }
        .oto-strateji { display: flex; align-items: center; gap: 5px; background-color: #0a1728; padding: 8px; border-radius: 5px; justify-content: center; } /* Ortaya hizalama eklendi */
        .oto-strateji-grup { display: flex; flex-direction: column; align-items: center; }
        #otoCarpanInput { width: 70px; padding: 5px; border: 1px solid #1e90ff; border-radius: 4px; background-color: #1e3d6d; color: #fff; text-align: center; font-size: 14px; }
        #otoStratejiSwitch { min-width: 60px; height: 30px; background-color: #333; border-radius: 15px; position: relative; cursor: pointer; }
        #otoStratejiSwitch.on { background-color: #00ff7f; }
        #otoStratejiSwitch .slider { width: 26px; height: 26px; background-color: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: transform 0.4s; }
        #otoStratejiSwitch.on .slider { transform: translateX(30px); }
        .note { grid-column: 1 / span 3; font-size: 11px; color: #8899aa; text-align: center; margin-top: 5px; }
        .oto-input-group { display: flex; flex-direction: column; gap: 5px; }
        .oto-input-group label { font-size: 12px; color: #aaa; }
        .oto-input-group input, .oto-input-group select { padding: 8px; background-color: #1e3d6d; border: 1px solid #1e90ff; color: #fff; border-radius: 4px; }
        #otoBaslatDurdurBtn { padding: 15px; font-size: 18px; font-weight: bold; background-color: #904100; color: #fff; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; }
        #otoBaslatDurdurBtn.active { background-color: #ffaa00; }
        .ses-btn { position: absolute; top: 20px; right: 20px; width: 40px; height: 40px; background-color: #1e3d6d; border: 1px solid #1e90ff; border-radius: 50%; color: #fff; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; z-index: 100; }
        .ses-btn:hover { background-color: #1e90ff; box-shadow: 0 0 10px #1e90ff; }

        /* --- MOBÄ°L UYUM DÃœZELTMELERÄ° (max-width: 768px) --- */
        @media (max-width: 768px) {
            .oyun-container { padding: 10px; }
            .header { flex-direction: column; align-items: flex-start; }
            .title { font-size: 24px; margin-bottom: 10px; }
            .bakiye { font-size: 20px; }
            .grafik-alani { height: 250px; }
            .carpan-gosterge { font-size: 40px; top: 10px; }

            /* KONTROL PANELÄ° DÃœZENÄ° */
            .kontrol-paneli { 
                grid-template-columns: 1fr; /* TÃ¼m elementler dikey sÄ±raya girsin */
                gap: 10px; 
            }

            /* HIZ AYARLARI FIX */
            .hiz-ayarlari { 
                grid-column: 1; 
                flex-wrap: wrap; 
                justify-content: space-between; 
                margin-bottom: 10px; 
                order: 1; 
                gap: 5px; /* Butonlar arasÄ±ndaki boÅŸluÄŸu azalt */
            }
            .hiz-ayarlari button {
                width: 22%; /* 4 butonun yan yana sÄ±ÄŸmasÄ± iÃ§in */
                font-size: 12px;
                padding: 6px 0; /* Dikey padding azalt */
                margin: 0;
            }

            /* BAHÄ°S KONTROL DÃœZELTMESÄ° */
            .bahis-kontrol {
                order: 2;
                gap: 8px; /* Dikey boÅŸluÄŸu azalt */
            }
            .bahis-secim button {
                padding: 8px 0;
                font-size: 14px;
            }
            
            /* OYNA BUTONU VE OTO STRATEJÄ° DÃœZELTMESÄ° FIX */
            .oyun-butonlari { 
                flex-direction: row; 
                justify-content: space-between;
                align-items: stretch; /* YÃ¼ksekliÄŸi yay */
                gap: 10px; 
                order: 3;
                padding: 5px 0;
            }
            #oynaToplaBtn { 
                flex-grow: 1; 
                padding: 15px; 
                font-size: 18px; 
                min-width: 45%; 
                height: 100%; 
            }
            .oto-strateji { 
                flex-grow: 1;
                width: 45%; 
                padding: 5px;
            }
            .oto-strateji-grup {
                gap: 2px;
            }
            
            /* SONUÃ‡LAR ALANI DÃœZELTMESÄ° */
            .sonuclar-alani { 
                grid-column: 1; 
                order: 4; 
                height: 60px; /* Daha az yer kapla */
                padding: 8px;
            }
            .sonuclar-liste {
                justify-content: flex-start; /* Sola hizala */
                flex-wrap: nowrap; /* Tek satÄ±rda kalmasÄ±nÄ± saÄŸla */
                overflow-x: auto; /* Yatay kaydÄ±rma ekle */
                padding-bottom: 5px;
            }

            /* OTO AYARLAR */
            .oto-ayarlar { 
                grid-template-columns: 1fr; 
                gap: 10px; 
                padding: 10px 5px; 
                order: 5;
            }
            .ses-btn { top: 10px; right: 10px; width: 35px; height: 35px; font-size: 16px; }
        }
    </style>
</head>
<body>

<div class="oyun-container">
    <div class="header">
        <div class="title">ðŸ¤‘ ZENGÄ°N DEDE</div>
        <div class="bakiye">â‚º<span id="bakiyeMiktari">100.00</span></div>
    </div>

    <div class="grafik-alani">
        <canvas id="grafikCanvas"></canvas>
        <div class="carpan-gosterge" id="carpanGosterge">0.00x</div>
    </div>
    
    <div class="kontrol-paneli">
        
        <div class="sonuclar-alani">
            <div style="font-size: 14px; margin-bottom: 5px; color: #1e90ff;">SON EN Ä°YÄ° SONUÃ‡LAR</div>
            <div class="sonuclar-liste" id="sonuclarListe">
                <span class="sonuc-item kazanc">1.64</span>
                <span class="sonuc-item kayip">0.00</span>
                <span class="sonuc-item kazanc">2.12</span>
                <span class="sonuc-item kayip">0.01</span>
                <span class="sonuc-item kazanc">1.28</span>
            </div>
        </div>

        <div class="bahis-kontrol">
            <div class="bahis-secim">
                <button onclick="bahisAyarla(10)">â‚º10.00</button>
                <button onclick="bahisAyarla(20)">â‚º20.00</button>
            </div>
            <div class="bahis-secim">
                <button onclick="bahisAyarla(50)">â‚º50.00</button>
                <button onclick="bahisAyarla(100)">â‚º100.00</button>
            </div>
            <div class="bahis-secim">
                <button onclick="bahisDegistir(0.5)">Ã·2</button>
                <button onclick="bahisDegistir(2)">x2</button>
            </div>
            <div class="bahis-secim">
                <button onclick="bahisAyarla(100)">MAX</button>
                <button onclick="bahisAyarla(10)">MIN</button>
            </div>
            <div class="oto-input-group" style="margin-top: 10px;">
                <label for="bahisMiktarInput">Bahis MiktarÄ±:</label>
                <input type="number" id="bahisMiktarInput" value="10.00" min="1" step="0.01">
            </div>
        </div>

        <div class="oyun-butonlari">
            <button id="oynaToplaBtn" onclick="oyunBaslatDurdur()">OYNA</button>
            <div class="oto-strateji">
                <div class="oto-strateji-grup">
                    <label style="font-size: 12px;">OTO CASH OUT:</label>
                    <input type="number" id="otoCarpanInput" value="1.20" min="1.01" step="0.01">
                </div>
                <div class="oto-strateji-grup">
                    <label style="font-size: 12px;">OTO STRATEJÄ°</label>
                    <div id="otoStratejiSwitch" onclick="toggleOtoStrateji()">
                        <div class="slider"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="hiz-ayarlari">
            <span style="font-weight: bold;">HIZ:</span>
            <button class="aktif" onclick="hizAyarla(1)">1.00x</button>
            <button onclick="hizAyarla(2)">2.00x</button>
            <button onclick="hizAyarla(0.5)">0.50x</button>
            <button onclick="hizAyarla(0.25)">0.25x</button>
        </div>
        
        <div class="oto-ayarlar">
            <div class="oto-input-group">
                <label for="tekrarSayisiInput">Tekrar SayÄ±sÄ± (Max):</label>
                <input type="number" id="tekrarSayisiInput" value="10" min="1">
            </div>
            <div class="oto-input-group">
                <label for="kazanincaInput">KazanÄ±rsa:</label>
                <select id="kazanincaInput">
                    <option value="reset">BaÅŸlangÄ±Ã§ Bahsine DÃ¶n</option>
                    <option value="x2">Bahsi Ä°ki KatÄ±na Ã‡Ä±kar</option>
                </select>
            </div>
            <div class="oto-input-group">
                <label for="kaybedinceInput">Kaybederse:</label>
                <select id="kaybedinceInput">
                    <option value="x2">Bahsi Ä°ki KatÄ±na Ã‡Ä±kar</option>
                    <option value="reset">BaÅŸlangÄ±Ã§ Bahsine DÃ¶n</option>
                </select>
            </div>
            <button id="otoBaslatDurdurBtn" onclick="otoOynatBaslatDurdur()">OTO OYNATMAYI BAÅžLAT</button>
        </div>

        <div class="note">
            Tur baÅŸladÄ±ktan sonra dahil olunan oyunlar, kazanÃ§larda %32 kesintiye tabidir. (SimÃ¼lasyon amaÃ§lÄ±dÄ±r, gerÃ§ek bir kesinti uygulanmamaktadÄ±r.)
        </div>

    </div>
</div>

<button class="ses-btn" id="sesBtn" onclick="toggleSes()">ðŸ”Š</button>

<script>
    const canvas = document.getElementById('grafikCanvas');
    const ctx = canvas.getContext('2d');
    const carpanGosterge = document.getElementById('carpanGosterge');
    const bakiyeMiktari = document.getElementById('bakiyeMiktari');
    const oynaToplaBtn = document.getElementById('oynaToplaBtn');
    const bahisMiktarInput = document.getElementById('bahisMiktarInput');
    const otoCarpanInput = document.getElementById('otoCarpanInput');
    const otoStratejiSwitch = document.getElementById('otoStratejiSwitch');
    const otoBaslatDurdurBtn = document.getElementById('otoBaslatDurdurBtn');
    const tekrarSayisiInput = document.getElementById('tekrarSayisiInput');
    const kazanincaInput = document.getElementById('kazanincaInput');
    const kaybedinceInput = document.getElementById('kaybedinceInput');
    const sonuclarListe = document.getElementById('sonuclarListe');
    const sesBtn = document.getElementById('sesBtn');

    let bakiye = 100.00;
    let bahisMiktari = parseFloat(bahisMiktarInput.value);
    let carpan = 1.00;
    let oyunDurumu = 'bekliyor'; // bekliyor, basladi, bitti
    let bahisYapildi = false;
    let cekildi = false;
    let intervalId;
    let oyunHizi = 1; // 1.00x varsayÄ±lan
    let otoStratejiAktif = false;
    let otoOynatmaAktif = false;
    let otoTurSayisi = 0;
    let baslangicBahisMiktari = bahisMiktari;
    let sonBahisKazanildi = false;
    let sesAcik = true;

    // Canvas BoyutlandÄ±rma
    const resizeCanvas = () => {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
        cizIzgara();
    };
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();

    // GrafiÄŸi Ã‡izme FonksiyonlarÄ±
    const cizIzgara = () => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        const satirSayisi = 8;
        const sutunSayisi = 12;
        const satirYuksekligi = canvas.height / satirSayisi;
        
        ctx.strokeStyle = 'rgba(26, 61, 109, 0.4)';
        ctx.lineWidth = 1;
        
        for (let i = 1; i < satirSayisi; i++) {
            ctx.beginPath();
            ctx.moveTo(0, i * satirYuksekligi);
            ctx.lineTo(canvas.width, i * satirYuksekligi);
            ctx.stroke();
        }
        
        // Dikey Ã§izgiler (opsiyonel)
        for (let i = 1; i < sutunSayisi; i++) {
            ctx.beginPath();
            ctx.moveTo(i * (canvas.width / sutunSayisi), 0);
            ctx.lineTo(i * (canvas.width / sutunSayisi), canvas.height);
            ctx.stroke();
        }
    };

    const cizGrafik = (noktalar) => {
        cizIzgara();
        
        if (noktalar.length < 2) return;

        const maxCarpan = 5; 
        const carpanOran = canvas.height / maxCarpan; 
        const adimGenisligi = canvas.width / (noktalar.length - 1);

        ctx.beginPath();
        ctx.moveTo(0, canvas.height - (noktalar[0] * carpanOran));
        
        for (let i = 1; i < noktalar.length; i++) {
            const x = i * adimGenisligi;
            let y = canvas.height - (noktalar[i] * carpanOran);
            
            // Ã‡arpanÄ± 10'un Ã¼zerine sabitle
            if (noktalar[i] > maxCarpan) {
                y = canvas.height - (maxCarpan * carpanOran);
            }

            ctx.lineTo(x, y);
        }
        
        ctx.strokeStyle = (oyunDurumu === 'bitti' && !cekildi) ? '#ff0040' : '#00ff7f';
        ctx.lineWidth = 3;
        ctx.stroke();
    };

    // Ã‡arpan Hesaplama ve Grafik Verisi
    let anlikCarpan = 1.00;
    let grafikNoktalari = [1.00];

    const yeniCarpanHesapla = () => {
        // GerÃ§ekÃ§i bir "Crash" noktasÄ± belirleme (1.01 ile 10 arasÄ±nda)
        const crashNoktasi = 1.0 + Math.random() * 9.0;
        
        let zaman = 0;
        let turDurumu = 'basladi';
        let hizlandirici = 1;

        grafikNoktalari = [1.00];

        const carpanGuncelle = () => {
            if (turDurumu === 'bitti') {
                clearInterval(intervalId);
                oyunBitti(anlikCarpan);
                return;
            }
            
            zaman += 0.05 * oyunHizi; 
            
            // Ã‡arpan artÄ±ÅŸ eÄŸrisi
            anlikCarpan = 1.00 + Math.pow(zaman, 1.5) * 0.2; 
            
            if (anlikCarpan >= crashNoktasi) {
                turDurumu = 'bitti';
                anlikCarpan = 0.00; // Crash
                carpanGosterge.classList.add('crash');
                carpanGosterge.innerHTML = 'CRASH';
            } else {
                // Ã‡arpanÄ± formatla
                const gorunenCarpan = anlikCarpan.toFixed(2);
                carpanGosterge.innerHTML = `${gorunenCarpan}x`;
                
                // Renk deÄŸiÅŸimi (1.00-1.50 sarÄ±, 1.50+ yeÅŸil)
                if (anlikCarpan >= 1.50) {
                    carpanGosterge.style.color = '#00ff7f';
                    carpanGosterge.style.textShadow = '0 0 20px rgba(0, 255, 127, 0.4)';
                } else if (anlikCarpan >= 1.01) {
                    carpanGosterge.style.color = '#ffaa00';
                    carpanGosterge.style.textShadow = '0 0 20px rgba(255, 170, 0, 0.4)';
                } else {
                    carpanGosterge.style.color = '#ffffff';
                    carpanGosterge.style.textShadow = 'none';
                }

                // Oto strateji veya manuel Cash-Out iÃ§in butonu gÃ¼ncelle
                if (bahisYapildi && !cekildi) {
                    oynaToplaBtn.innerHTML = `TOPLA @ ${gorunenCarpan}x`;
                }
            }

            grafikNoktalari.push(anlikCarpan);
            cizGrafik(grafikNoktalari);

            // Oto strateji kontrolÃ¼
            if (bahisYapildi && !cekildi && otoStratejiAktif) {
                const otoCarpan = parseFloat(otoCarpanInput.value);
                if (anlikCarpan >= otoCarpan) {
                    cashOut();
                }
            }
        };

        // Yeni tur baÅŸlamadan Ã¶nce beklemeyi simÃ¼le et
        setTimeout(() => {
            carpanGosterge.classList.remove('crash');
            carpanGosterge.innerHTML = 'BAÅžLIYOR...';
            
            setTimeout(() => {
                // Tur gerÃ§ekten baÅŸladÄ±
                if (bahisYapildi) {
                    oynaToplaBtn.disabled = false; // Cash-out iÃ§in butonu etkinleÅŸtir
                    oynaToplaBtn.innerHTML = `TOPLA @ 1.00x`; 
                    oynaToplaBtn.classList.add('topla-modu');
                }
                
                intervalId = setInterval(carpanGuncelle, 50 / oyunHizi); // 50ms/hÄ±z
            }, 1500 / oyunHizi); // 1.5 saniye bekleme
        }, 500); // 0.5 saniye bekleme
    };

    // --- Oyun Kontrol FonksiyonlarÄ± ---
    
    const oyunBaslatDurdur = () => {
        if (oyunDurumu === 'bekliyor') {
            if (bakiye < bahisMiktari) {
                alert('Yetersiz Bakiye!');
                return;
            }
            
            // Bahis Yap
            bakiye -= bahisMiktari;
            bakiyeGuncelle();
            bahisYapildi = true;
            cekildi = false;
            
            // UI GÃ¼ncelle
            oynaToplaBtn.innerHTML = 'Bekleniyor...';
            oynaToplaBtn.disabled = true; // Oyun baÅŸlayana kadar Cash-out'u engelle
            oynaToplaBtn.classList.remove('topla-modu');

            // Oyunu BaÅŸlat
            oyunDurumu = 'basladi';
            yeniCarpanHesapla();
        } else if (oyunDurumu === 'basladi' && bahisYapildi && !cekildi) {
            cashOut();
        }
    };

    const cashOut = () => {
        if (!bahisYapildi || cekildi || anlikCarpan <= 1.00) return;
        
        cekildi = true;
        const kazanilanMiktar = bahisMiktari * anlikCarpan;
        bakiye += kazanilanMiktar;
        bakiyeGuncelle();
        
        oynaToplaBtn.innerHTML = `KAZANÃ‡ â‚º${(kazanilanMiktar).toFixed(2)}`;
        oynaToplaBtn.classList.add('topla-modu');
        oynaToplaBtn.disabled = true; // Tekrar Ã§ekilmesini engelle

        sonBahisKazanildi = true;
    };

    const oyunBitti = (finalCarpan) => {
        clearInterval(intervalId);
        oyunDurumu = 'bitti';

        // SonuÃ§larÄ± Listeye Ekle
        sonucEkle(finalCarpan);

        if (bahisYapildi && !cekildi) {
            // Bahis yapÄ±ldÄ± ama Ã§ekilemedi (Kaybedildi)
            oynaToplaBtn.innerHTML = 'KAYIP';
            oynaToplaBtn.classList.remove('topla-modu');
            oynaToplaBtn.disabled = true;
            sonBahisKazanildi = false;
        } else if (cekildi) {
            // BaÅŸarÄ±lÄ± Cash-out oldu (buton zaten gÃ¼ncellenmiÅŸti)
            // Sadece tekrar tÄ±klamayÄ± engelle
        } else if (!bahisYapildi) {
             // Bahis yapÄ±lmadÄ±, sadece izlendi
             oynaToplaBtn.innerHTML = 'OYNA';
             oynaToplaBtn.classList.remove('topla-modu');
             oynaToplaBtn.disabled = false;
        }

        // 3 saniye sonra yeni tur bekle
        setTimeout(() => {
            // UI'yÄ± sÄ±fÄ±rla
            carpanGosterge.classList.remove('crash');
            carpanGosterge.innerHTML = '0.00x';
            oynaToplaBtn.innerHTML = 'OYNA';
            oynaToplaBtn.classList.remove('topla-modu');
            oynaToplaBtn.disabled = false;

            // Oyun durumunu sÄ±fÄ±rla
            oyunDurumu = 'bekliyor';
            bahisYapildi = false;
            cekildi = false;
            anlikCarpan = 1.00;
            grafikNoktalari = [1.00];
            cizGrafik(grafikNoktalari);

            // Oto Oynatma KontrolÃ¼
            if (otoOynatmaAktif && otoTurSayisi > 0) {
                otoTurSayisi--;
                otoBaslatDurdurBtn.innerHTML = `Kalan Tur: ${otoTurSayisi}`;
                otoOynat();
            } else if (otoOynatmaAktif && otoTurSayisi === 0) {
                otoOynatBaslatDurdur(); // Oto oynatmayÄ± durdur
                alert("Oto oynatma tamamlandÄ±.");
            }
            
        }, 3000);
    };

    // --- YardÄ±mcÄ± Fonksiyonlar ---

    const bakiyeGuncelle = () => {
        bakiyeMiktari.textContent = bakiye.toFixed(2);
    };

    const bahisAyarla = (miktar) => {
        bahisMiktari = miktar;
        bahisMiktarInput.value = miktar.toFixed(2);
        baslangicBahisMiktari = miktar;
    };

    const bahisDegistir = (carpan) => {
        const yeniMiktar = bahisMiktari * carpan;
        bahisAyarla(Math.max(1, yeniMiktar)); // Minimum 1 TL
    };

    bahisMiktarInput.addEventListener('change', () => {
        bahisMiktari = parseFloat(bahisMiktarInput.value) || 10.00;
        bahisMiktari = Math.max(1, bahisMiktari);
        bahisMiktarInput.value = bahisMiktari.toFixed(2);
        baslangicBahisMiktari = bahisMiktari;
    });

    const hizAyarla = (hiz) => {
        oyunHizi = hiz;
        document.querySelectorAll('.hiz-ayarlari button').forEach(btn => {
            btn.classList.remove('aktif');
            if (btn.textContent.includes(hiz.toFixed(2))) {
                btn.classList.add('aktif');
            }
        });
    };
    
    const sonucEkle = (carpan) => {
        const item = document.createElement('span');
        const carpanDegeri = carpan.toFixed(2);
        item.textContent = carpanDegeri;
        
        if (carpan < 1.00) {
            item.classList.add('sonuc-item', 'kayip');
        } else {
            item.classList.add('sonuc-item', 'kazanc');
        }
        
        // Listenin baÅŸÄ±na ekle
        if (sonuclarListe.firstChild) {
            sonuclarListe.insertBefore(item, sonuclarListe.firstChild);
        } else {
            sonuclarListe.appendChild(item);
        }
        
        // Listeyi 20 ile sÄ±nÄ±rla
        while (sonuclarListe.children.length > 20) {
            sonuclarListe.removeChild(sonuclarListe.lastChild);
        }
    };
    
    // Ses KontrolÃ¼ (SimÃ¼lasyon amaÃ§lÄ±dÄ±r, gerÃ§ek ses eklenmemiÅŸtir)
    const toggleSes = () => {
        sesAcik = !sesAcik;
        sesBtn.textContent = sesAcik ? 'ðŸ”Š' : 'ðŸ”‡';
    };

    // Oto Strateji KontrolÃ¼
    const toggleOtoStrateji = () => {
        otoStratejiAktif = !otoStratejiAktif;
        otoStratejiSwitch.classList.toggle('on', otoStratejiAktif);
    };

    // Oto Oynatma KontrolÃ¼
    const otoOynatBaslatDurdur = () => {
        if (oyunDurumu !== 'bekliyor' && otoOynatmaAktif) return; // Tur devam ediyorsa sadece durdurulabilir
        
        otoOynatmaAktif = !otoOynatmaAktif;
        if (otoOynatmaAktif) {
            otoTurSayisi = parseInt(tekrarSayisiInput.value) || 10;
            otoBaslatDurdurBtn.classList.add('active');
            otoBaslatDurdurBtn.innerHTML = `Kalan Tur: ${otoTurSayisi}`;
            otoOynat();
        } else {
            otoBaslatDurdurBtn.classList.remove('active');
            otoBaslatDurdurBtn.innerHTML = 'OTO OYNATMAYI BAÅžLAT';
        }
    };

    const otoOynat = () => {
        if (!otoOynatmaAktif || oyunDurumu !== 'bekliyor') return;

        // Bahis MiktarÄ± Ayarlama Stratejisi
        // Tur 1'den bÃ¼yÃ¼kse (yani ilk tur deÄŸilse) Ã¶nceki sonucun stratejisini uygula
        if (otoTurSayisi < parseInt(tekrarSayisiInput.value) - 1) { 
            if (sonBahisKazanildi) {
                if (kazanincaInput.value === 'reset') {
                    bahisAyarla(baslangicBahisMiktari);
                } else if (kazanincaInput.value === 'x2') {
                    bahisDegistir(2);
                }
            } else { // KayÄ±p
                if (kaybedinceInput.value === 'reset') {
                    bahisAyarla(baslangicBahisMiktari);
                } else if (kaybedinceInput.value === 'x2') {
                    bahisDegistir(2);
                }
            }
        }
        
        // Oyna fonksiyonunu Ã§aÄŸÄ±r
        oyunBaslatDurdur();
    };
    
    // BaÅŸlangÄ±Ã§ta bahis miktarÄ±nÄ± input ile eÅŸle
    bahisAyarla(parseFloat(bahisMiktarInput.value));

</script>

</body>
</html>