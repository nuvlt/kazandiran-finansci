<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ‘´ Zengin Dede - CRASH FX Modu V10.0</title>
    <style>
        /* BASE CSS */
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #0d1e3a; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; color: #fff; }
        .oyun-container { width: 800px; max-width: 95%; background-color: #0f274a; border: 4px solid #1e90ff; border-radius: 10px; padding: 20px; box-shadow: 0 0 30px rgba(30, 144, 255, 0.5); position: relative; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px solid #1e90ff; }
        .title { font-size: 32px; font-weight: bold; color: #00ff7f; text-shadow: 0 0 5px #00ff7f; }
        .bakiye { font-size: 24px; color: #fff; background-color: #0f274a; padding: 5px 10px; border-radius: 5px; border: 1px solid #1e90ff; margin-right: 50px; }
        
        .grafik-alani { position: relative; height: 350px; background-color: #0a1728; border: 2px solid #00ff7f; border-radius: 8px; margin-bottom: 20px; background-image: linear-gradient(rgba(26, 61, 109, 0.3) 1px, transparent 1px), linear-gradient(90deg, rgba(26, 61, 109, 0.3) 1px, transparent 1px); background-size: 40px 40px; overflow: hidden; }
        
        /* GÃ–STERGE TASARIMI - CRASH EFEKTÄ° GÃœNCELLENDÄ° */
        .carpan-gosterge { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); font-size: 56px; font-weight: 800; color: #00ff7f; text-shadow: 0 0 20px rgba(0, 255, 127, 0.4); z-index: 10; background-color: rgba(10, 23, 40, 0.7); padding: 5px 20px; border-radius: 10px; border: 1px solid #1e90ff; font-variant-numeric: tabular-nums; transition: all 0.1s ease; }
        
        /* KÄ±rmÄ±zÄ± Kutu Efekti */
        .carpan-gosterge.crash { 
            color: #ff0040; 
            text-shadow: 0 0 20px #ff0040; 
            border: 3px solid #ff0040; 
            background-color: rgba(50, 0, 0, 0.85);
            box-shadow: 0 0 40px rgba(255, 0, 64, 0.4);
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
        }

        @keyframes shake {
            10%, 90% { transform: translateX(-51%); }
            20%, 80% { transform: translateX(-49%); }
            30%, 50%, 70% { transform: translateX(-51%); }
            40%, 60% { transform: translateX(-49%); }
        }

        #grafikCanvas { position: absolute; top: 0; left: 0; transition: transform 0.1s ease-out; } 
        
        /* DÄ°ÄžER CSS AYARLARI (AYNI) */
        .kontrol-paneli { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
        .hiz-ayarlari { grid-column: 1 / span 3; display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .hiz-ayarlari button { background-color: #1e3d6d; color: #fff; padding: 8px 15px; border: 1px solid #1e90ff; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; }
        .hiz-ayarlari button:hover { background-color: #1a5c96; }
        .hiz-ayarlari .aktif { background-color: #1e90ff; border-color: #fff; font-weight: bold; }
        .sonuclar-alani { background-color: #0a1728; border: 2px solid #1e90ff; border-radius: 5px; padding: 10px; height: 150px; overflow-y: auto; }
        .sonuclar-liste { display: flex; flex-wrap: wrap; gap: 5px; }
        .sonuc-item { background-color: #4b0082; padding: 4px 8px; border-radius: 4px; font-size: 13px; font-weight: bold; }
        .sonuc-item.kayip { background-color: #3d0d0d; color: #ff6666; border: 1px solid #ff4d4d; }
        .sonuc-item.kazanc { background-color: #0d3d1e; color: #66ff99; border: 1px solid #00ff7f; }
        .bahis-kontrol { display: flex; flex-direction: column; gap: 8px; }
        .bahis-butonlari { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        .bahis-butonlari button { background-color: #333; color: #fff; padding: 10px 0; border: 1px solid #666; border-radius: 5px; cursor: pointer; }
        .bahis-secim { display: flex; gap: 5px; }
        .bahis-secim button { flex-grow: 1; padding: 10px 0; font-size: 16px; background-color: #1e3d6d; border: 1px solid #1e90ff; color: #fff; border-radius: 5px; cursor: pointer; }
        .oyun-butonlari { display: flex; flex-direction: column; gap: 8px; }
        #oynaToplaBtn { background-color: #00cc66; color: white; padding: 20px; border: none; border-radius: 8px; font-size: 24px; font-weight: bold; cursor: pointer; box-shadow: 0 5px #00994d; }
        #oynaToplaBtn:active { box-shadow: 0 2px #00994d; transform: translateY(3px); }
        #oynaToplaBtn.topla-modu { background-color: #ffaa00; box-shadow: 0 5px #cc8800; }
        #oynaToplaBtn.topla-modu:active { box-shadow: 0 2px #cc8800; }
        .oto-ayarlar { grid-column: 1 / span 3; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px; padding: 10px; border: 1px dashed #1e90ff; border-radius: 8px; }
        .oto-strateji { display: flex; align-items: center; gap: 5px; background-color: #0a1728; padding: 8px; border-radius: 5px; }
        .oto-strateji-grup { display: flex; flex-direction: column; align-items: center; }
        #otoCarpanInput { width: 70px; padding: 5px; border: 1px solid #1e90ff; border-radius: 4px; background-color: #1e3d6d; color: #fff; text-align: center; font-size: 14px; }
        #otoStratejiSwitch { min-width: 60px; height: 30px; background-color: #333; border-radius: 15px; position: relative; cursor: pointer; }
        #otoStratejiSwitch.on { background-color: #00ff7f; }
        #otoStratejiSwitch .slider { width: 26px; height: 26px; background-color: white; border-radius: 50%; position: absolute; top: 2px; left: 2px; transition: transform 0.4s; }
        #otoStratejiSwitch.on .slider { transform: translateX(30px); }
        .note { grid-column: 1 / span 3; font-size: 11px; color: #8899aa; text-align: center; margin-top: 5px; }
        .oto-input-group { display: flex; flex-direction: column; gap: 5px; }
        .oto-input-group label { font-size: 12px; color: #aaa; }
        .oto-input-group input, .oto-input-group select { padding: 8px; background-color: #1e3d6d; border: 1px solid #1e90ff; color: #fff; border-radius: 4px; }
        #otoBaslatDurdurBtn { padding: 15px; font-size: 18px; font-weight: bold; background-color: #904100; color: #fff; border: none; border-radius: 5px; cursor: pointer; transition: background-color 0.2s; }
        #otoBaslatDurdurBtn.active { background-color: #ffaa00; }
        .ses-btn { position: absolute; top: 20px; right: 20px; width: 40px; height: 40px; background-color: #1e3d6d; border: 1px solid #1e90ff; border-radius: 50%; color: #fff; font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.2s; z-index: 100; }
        .ses-btn:hover { background-color: #1e90ff; box-shadow: 0 0 10px #1e90ff; }

        @media (max-width: 768px) {
            .oyun-container { padding: 10px; }
            .header { flex-direction: column; align-items: flex-start; }
            .title { font-size: 24px; margin-bottom: 10px; }
            .bakiye { font-size: 20px; }
            .grafik-alani { height: 250px; }
            .carpan-gosterge { font-size: 40px; top: 10px; }
            .kontrol-paneli { grid-template-columns: 1fr; gap: 10px; }
            .sonuclar-alani { height: 100px; }
            .hiz-ayarlari { grid-column: 1; flex-wrap: wrap; justify-content: center; margin-bottom: 10px; }
            .oyun-butonlari { flex-direction: row; gap: 10px; }
            #oynaToplaBtn { flex-grow: 1; padding: 15px; font-size: 18px; }
            .oto-strateji { flex-shrink: 0; }
            .oto-ayarlar { grid-template-columns: 1fr; gap: 10px; padding: 10px 5px; }
            .ses-btn { top: 10px; right: 10px; width: 35px; height: 35px; font-size: 16px; }
        }
    </style>
</head>
<body>

<audio id="backgroundMusic" loop>
    <source src="background.mp3" type="audio/mpeg">
</audio>

<div class="oyun-container">
    <button id="sesButonu" class="ses-btn" onclick="toggleSes()">ðŸ”‡</button>

    <div class="header">
        <div class="title">ðŸ‘´ðŸ’° ZENGÄ°N DEDE</div>
        <div class="bakiye" id="bakiyeGosterge">â‚º100.00</div>
    </div>

    <div class="grafik-alani">
        <div class="carpan-gosterge" id="carpanGosterge">1.00x</div>
        <canvas id="grafikCanvas"></canvas>
    </div>

    <div class="hiz-ayarlari">
        <span style="font-weight: bold;">HIZ:</span>
        <button onclick="setHiz(0.5)">0.50x</button>
        <button class="aktif" onclick="setHiz(1.0)">1.00x</button>
        <button onclick="setHiz(2.0)">2.00x</button>
        <button onclick="setHiz(5.0)">5.00x</button>
    </div>

    <div class="kontrol-paneli">
        <div class="sonuclar-alani">
            <div class="sonuclar-liste" id="sonuclarListesi"></div>
        </div>

        <div class="bahis-kontrol">
            <div class="bahis-secim">
                <button onclick="ayarlaBahis(-10)">-</button>
                <button style="flex-grow: 2;" id="aktifBahisGosterge">â‚º10.00</button>
                <button onclick="ayarlaBahis(10)">+</button>
            </div>
            <div class="bahis-butonlari">
                <button onclick="setBahis(10)">â‚º10</button>
                <button onclick="setBahis(20)">â‚º20</button>
                <button onclick="setBahis(50)">â‚º50</button>
                <button onclick="setBahis(100)">â‚º100</button>
            </div>
        </div>

        <div class="oyun-butonlari">
            <button id="oynaToplaBtn" onclick="oynaVeyaTopla()">OYNA</button>
            
            <div class="oto-strateji">
                <div class="oto-strateji-grup">
                    <div id="otoStratejiSwitch" onclick="toggleOtoStrateji()"><div class="slider"></div></div>
                    <span style="font-size: 10px;">OTO CASH OUT</span>
                </div>

                <div class="oto-strateji-grup" style="flex-grow: 1;">
                    <input type="number" id="otoCarpanInput" value="1.20" min="1.01" step="0.01">
                    <span style="font-size: 10px;">TOPLAMA Ã‡ARPANI</span>
                </div>
            </div>
        </div>
        
        <div class="oto-ayarlar">
            <button id="otoBaslatDurdurBtn" onclick="toggleOtoBet()">OTO OYNATMAYI BAÅžLAT</button>

            <div class="oto-input-group">
                <label for="tekrarSayisi">Tekrar SayÄ±sÄ± (Max)</label>
                <input type="number" id="tekrarSayisi" value="10" min="1">
            </div>

            <div class="oto-input-group">
                <label for="kayipStratejisi">KayÄ±pta Bahis</label>
                <select id="kayipStratejisi">
                    <option value="aynÄ±">AynÄ± Tut</option>
                    <option value="iki_kat">Ä°ki KatÄ±na Ã‡Ä±kar (Martingale)</option>
                    <option value="baslangic">BaÅŸlangÄ±ca DÃ¶n</option>
                </select>
            </div>
            
            <div class="oto-input-group">
                <label for="kazancStratejisi">KazanÃ§ta Bahis</label>
                <select id="kazancStratejisi">
                    <option value="aynÄ±">AynÄ± Tut</option>
                    <option value="iki_kat">Ä°ki KatÄ±na Ã‡Ä±kar</option>
                    <option value="baslangic">BaÅŸlangÄ±ca DÃ¶n</option>
                </select>
            </div>
        </div>
        
        <div class="note">KazanÃ§larda %32 kesinti uygulanÄ±r. Max KazanÃ§: â‚º10.000.000</div>
    </div>
</div>

<script>
    const MAX_KAZANC = 10000000.00;
    let UPDATE_INTERVAL = 150; 
    const CRASH_FALL_SPEED = 0.05; // Her adÄ±mda dÃ¼ÅŸme miktarÄ± (Ã¶rneÄŸin 0.05x)
    
    // BAKIYE VE BAHÄ°S
    let bakiye = 100.00;
    let aktifBahis = 10.00;
    const BASLANGIC_BAHIS = 10.00; 
    
    // OYUN DURUMLARI: 'bekliyor', 'oynuyor', 'bitti', 'crash_animasyonu'
    let oyunDurumu = 'bekliyor'; 
    let mevcutCarpan = 1.00;
    let oyunHiziCarpani = 1.0; 
    let animasyonFrameId;
    let sonGuncellemeZamani = 0;

    // OTO DEÄžÄ°ÅžKENLER
    let otoStratejiAktif = false;
    let otoToplamaCarpani = 1.20; 
    let otoBetAktif = false;
    let oynananElSayisi = 0;
    let sonElDurumu = 'baslangic'; 

    // GRAFÄ°K DEÄžÄ°ÅžKENLERÄ°
    let grafikNoktalari = []; 
    let dalgaFazÄ± = 0; 
    let anaTrend = 0; 
    let dinamikZoom = 1.0; 

    // DOM
    const uiBakiye = document.getElementById('bakiyeGosterge');
    const uiBahis = document.getElementById('aktifBahisGosterge');
    const uiCarpan = document.getElementById('carpanGosterge');
    const uiBtn = document.getElementById('oynaToplaBtn');
    const uiListe = document.getElementById('sonuclarListesi');
    const canvas = document.getElementById('grafikCanvas');
    const backgroundMusic = document.getElementById('backgroundMusic');
    const sesBtn = document.getElementById('sesButonu');
    const otoSwitch = document.getElementById('otoStratejiSwitch');
    const otoCarpanInput = document.getElementById('otoCarpanInput');
    const otoBaslatDurdurBtn = document.getElementById('otoBaslatDurdurBtn');
    const tekrarSayisiInput = document.getElementById('tekrarSayisi');
    const kayipStratejisiSelect = document.getElementById('kayipStratejisi');
    const kazancStratejisiSelect = document.getElementById('kazancStratejisi');

    let ctx; 

    // --- BAÅžLANGIÃ‡ ---
    document.addEventListener('DOMContentLoaded', () => {
        if (canvas) {
            ctx = canvas.getContext('2d');
            resizeCanvas();
            drawGraph(); 
        } else {
            console.error("Grafik tuvali bulunamadÄ±.");
        }
        updateUI(); 
        guncelleOtoCarpan(); 
    });

    function resizeCanvas() {
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
        if(grafikNoktalari.length > 0) drawGraph();
    }
    window.addEventListener('resize', resizeCanvas);

    function updateUI() {
        uiBakiye.textContent = `â‚º${bakiye.toFixed(2)}`;
        uiBahis.textContent = `â‚º${aktifBahis.toFixed(2)}`;
    }
    
    function toggleSes() {
        if (backgroundMusic.paused) {
            backgroundMusic.play().then(() => {
                backgroundMusic.muted = false;
                sesBtn.textContent = "ðŸ”Š";
            }).catch(e => console.log("Ses hatasÄ±:", e));
        } else {
            backgroundMusic.muted = !backgroundMusic.muted;
            sesBtn.textContent = backgroundMusic.muted ? "ðŸ”‡" : "ðŸ”Š";
        }
    }

    function guncelleOtoCarpan() {
        let val = parseFloat(otoCarpanInput.value);
        if (isNaN(val) || val < 1.01) val = 1.01;
        otoToplamaCarpani = val;
    }
    
    otoCarpanInput.addEventListener('input', guncelleOtoCarpan);
    otoCarpanInput.addEventListener('change', () => {
        guncelleOtoCarpan();
        otoCarpanInput.value = otoToplamaCarpani.toFixed(2);
    });

    function toggleOtoBet() {
        if (oyunDurumu === 'oynuyor' || oyunDurumu === 'crash_animasyonu') return;

        otoBetAktif = !otoBetAktif;
        if (otoBetAktif) {
            otoBaslatDurdurBtn.textContent = "OTO OYNATMAYI DURDUR";
            otoBaslatDurdurBtn.classList.add('active');
            oynananElSayisi = 0;
            sonElDurumu = 'baslangic';
            uygulaOtoBetStratejisi();
            oyunuBaslat();
        } else {
            otoBaslatDurdurBtn.textContent = "OTO OYNATMAYI BAÅžLAT";
            otoBaslatDurdurBtn.classList.remove('active');
        }
    }
    
    function uygulaOtoBetStratejisi(oncekiBahisMiktari) {
        let strateji = '';
        let yeniBahis = oncekiBahisMiktari || aktifBahis;

        if (sonElDurumu === 'kayÄ±p') {
            strateji = kayipStratejisiSelect.value;
        } else if (sonElDurumu === 'kazanÃ§') {
            strateji = kazancStratejisiSelect.value;
        } else {
            aktifBahis = BASLANGIC_BAHIS;
            return;
        }

        switch (strateji) {
            case 'iki_kat': yeniBahis *= 2; break;
            case 'baslangic': yeniBahis = BASLANGIC_BAHIS; break;
            case 'aynÄ±': default: yeniBahis = oncekiBahisMiktari; break;
        }
        
        aktifBahis = Math.max(1.00, Math.min(yeniBahis, 500.00));
        updateUI();
    }

    function oyunuTekrarBaslat() {
        if (otoBetAktif) {
            oynananElSayisi++;
            const maxTekrar = parseInt(tekrarSayisiInput.value);
            if (oynananElSayisi >= maxTekrar) {
                toggleOtoBet();
                return;
            }
            const oncekiBahis = aktifBahis;
            uygulaOtoBetStratejisi(oncekiBahis);
            setTimeout(() => { oyunuBaslat(); }, 500); 
        } else {
            oyunDurumu = 'bekliyor';
        }
    }

    function toggleOtoStrateji() {
        if(oyunDurumu === 'oynuyor' || oyunDurumu === 'crash_animasyonu') return; 
        
        otoStratejiAktif = !otoStratejiAktif;
        if (otoStratejiAktif) {
            otoSwitch.classList.add('on');
            guncelleOtoCarpan(); 
        } else {
            otoSwitch.classList.remove('on');
        }
    }
    
    function setBahis(miktar) { if(oyunDurumu !== 'oynuyor' && oyunDurumu !== 'crash_animasyonu') { aktifBahis = miktar; updateUI(); } }
    function ayarlaBahis(d) { setBahis(aktifBahis + d); }
    function setHiz(x) { 
        oyunHiziCarpani = x; 
        document.querySelectorAll('.hiz-ayarlari button').forEach(b => b.classList.remove('aktif'));
        event.target.classList.add('aktif');
    }

    function oyunuBaslat() {
        if (bakiye < aktifBahis) { 
            if (otoBetAktif) {
                toggleOtoBet();
                alert("Oto Oynatma Durduruldu: Bakiye Yetersiz!");
            } else {
                alert("Bakiye Yetersiz");
            }
            return; 
        }
        
        if (otoStratejiAktif) guncelleOtoCarpan();
        
        try {
            if (backgroundMusic.paused && backgroundMusic.currentTime > 0) {
                 backgroundMusic.play().catch(e => {});
            }
        } catch (e) {}

        bakiye -= aktifBahis;
        updateUI();
        
        oyunDurumu = 'oynuyor';
        mevcutCarpan = 1.00;
        grafikNoktalari = [{val: 1.00}]; 
        
        dalgaFazÄ± = Math.random() * 10;
        anaTrend = 0.01; 
        dinamikZoom = 1.0; 

        uiBtn.textContent = "TOPLA";
        uiBtn.classList.add('topla-modu');
        uiCarpan.textContent = "1.00x";
        uiCarpan.className = "carpan-gosterge"; 
        uiCarpan.style.color = "#00ff7f";
        
        sonGuncellemeZamani = performance.now();
        animasyonFrameId = requestAnimationFrame(oyunDongusu);
    }

    function oyunDongusu(zaman) {
        if (oyunDurumu === 'bekliyor' || oyunDurumu === 'bitti') return;

        let hedeflenenSure = UPDATE_INTERVAL / oyunHiziCarpani;
        if (oyunDurumu === 'crash_animasyonu') hedeflenenSure = 40; // DÃ¼ÅŸÃ¼ÅŸ hÄ±zÄ±

        if (zaman - sonGuncellemeZamani > hedeflenenSure) {
            sonGuncellemeZamani = zaman;
            if (oyunDurumu === 'oynuyor') birAdimIlerle();
            else if (oyunDurumu === 'crash_animasyonu') crashAnimasyonuAdimi();
        }
        requestAnimationFrame(oyunDongusu);
    }

    // --- YENÄ°: CRASH ANÄ°MASYONU ---
    function crashAnimasyonuAdimi() {
        // Ã‡arpanÄ± dÃ¼ÅŸÃ¼r (Daha yavaÅŸ bir dÃ¼ÅŸÃ¼ÅŸ iÃ§in CRASH_FALL_SPEED kullanÄ±yoruz)
        mevcutCarpan = Math.max(0, mevcutCarpan - CRASH_FALL_SPEED); 

        if (mevcutCarpan <= 0.01) { // 0'a Ã§ok yaklaÅŸtÄ±ÄŸÄ±nda tam 0 yapalÄ±m
            mevcutCarpan = 0.00;
            oyunuBitir(false); // Animasyon bitti, oyunu sonlandÄ±r
            return;
        }
        
        // GrafiÄŸe dÃ¼ÅŸÃ¼ÅŸÃ¼ kaydet
        grafikNoktalari.push({ val: parseFloat(mevcutCarpan.toFixed(2)) });
        // Grafik noktalarÄ±nÄ± sÄ±nÄ±rlama (isteÄŸe baÄŸlÄ±, daha uzun bir dÃ¼ÅŸÃ¼ÅŸ iÃ§in artÄ±rÄ±labilir)
        if(grafikNoktalari.length > 50) grafikNoktalari.shift(); 
        
        uiCarpan.textContent = mevcutCarpan.toFixed(2) + "x";
        uiCarpan.classList.add('crash'); 
        
        drawGraph();
    }

    function birAdimIlerle() {
        // --- OTO CASH OUT KONTROLÃœ ---
        if (otoStratejiAktif && oyunDurumu === 'oynuyor') {
            const yuvarlakMevcut = Math.round(mevcutCarpan * 100) / 100;
            const yuvarlakHedef = Math.round(otoToplamaCarpani * 100) / 100;
            if (yuvarlakMevcut >= yuvarlakHedef) {
                oyunuBitir(true); 
                return;
            }
        }
        
        dalgaFazÄ± += 0.2; 
        let dalgaEtkisi = Math.sin(dalgaFazÄ±) * 0.10; 
        let gurultu = (Math.random() - 0.5) * 0.15; 
        
        if (mevcutCarpan < 0.80) anaTrend += 0.003; else anaTrend = 0.015;

        let degisim = anaTrend + dalgaEtkisi + gurultu;
        if (Math.random() < 0.15) degisim -= 0.20; 

        let yeniDeger = mevcutCarpan + degisim;
        let gercekDegisim = yeniDeger - mevcutCarpan;
        
        if (yeniDeger < 0.15) {
            yeniDeger = 0.15;
            if(Math.random() < 0.5) anaTrend = 0.05; 
        }

        mevcutCarpan = yeniDeger;

        let hiz = Math.abs(gercekDegisim) * 20; 
        if (mevcutCarpan > 2.00) hiz += 0.5;
        let hedefZoom = 1.0 + Math.min(hiz, 0.4); 
        dinamikZoom += (hedefZoom - dinamikZoom) * 0.1; 

        let patlamaSansi = 0.005; 
        if (mevcutCarpan < 0.50) patlamaSansi = 0.01; 
        if (mevcutCarpan > 2.0) patlamaSansi = 0.015;
        if (mevcutCarpan > 5.0) patlamaSansi = 0.04;
        if (mevcutCarpan > 10.0) patlamaSansi = 0.08;

        if (Math
