<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KazandÄ±ran FinansÃ§Ä± - Crash Model</title>
    <style>
        /* CSS Kodu (Ã–nceki SÃ¼rÃ¼mle AynÄ±) */
        body {
            font-family: Arial, sans-serif;
            background-color: #0d1e3a; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: #fff;
        }
        .oyun-container {
            width: 800px;
            max-width: 95%;
            background-color: #0f274a;
            border: 4px solid #1e90ff;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 0 30px rgba(30, 144, 255, 0.5);
        }

        /* BaÅŸlÄ±k ve Bakiye */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #1e90ff;
        }
        .title {
            font-size: 32px;
            font-weight: bold;
            color: #00ff7f;
            text-shadow: 0 0 5px #00ff7f;
        }
        .bakiye {
            font-size: 24px;
            color: #fff;
            background-color: #0f274a;
            padding: 5px 10px;
            border-radius: 5px;
            border: 1px solid #1e90ff;
        }

        /* Grafik AlanÄ± */
        .grafik-alani {
            position: relative;
            height: 350px;
            background-color: #0a1728;
            border: 2px solid #00ff7f;
            border-radius: 8px;
            margin-bottom: 20px;
            background-image: linear-gradient(to right, #1a3d6d 1px, transparent 1px),
                              linear-gradient(to bottom, #1a3d6d 1px, transparent 1px);
            background-size: 50px 50px;
            overflow: hidden;
        }
        .carpan-gosterge {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 48px;
            font-weight: bold;
            color: #00ff7f;
            text-shadow: 0 0 10px #00ff7f;
            z-index: 10;
        }
        .carpan-gosterge.crash {
            color: #ff4d4d; /* KÄ±rmÄ±zÄ± */
        }

        #grafikCanvas {
            position: absolute;
            top: 0;
            left: 0;
        }

        /* Alt Kontrol Paneli */
        .kontrol-paneli {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 15px;
        }

        /* HÄ±z AyarlarÄ± */
        .hiz-ayarlari {
            grid-column: 1 / span 3;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        .hiz-ayarlari button {
            background-color: #1e3d6d;
            color: #fff;
            padding: 8px 15px;
            border: 1px solid #1e90ff;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .hiz-ayarlari button:hover {
            background-color: #1a5c96;
        }
        .hiz-ayarlari .aktif {
            background-color: #1e90ff;
            border-color: #fff;
            font-weight: bold;
        }

        /* SonuÃ§lar AlanÄ± */
        .sonuclar-alani {
            background-color: #0a1728;
            border: 2px solid #1e90ff;
            border-radius: 5px;
            padding: 10px;
            height: 150px;
            overflow-y: auto;
        }
        .sonuclar-alani h3 {
            margin-top: 0;
            color: #00ff7f;
            border-bottom: 1px solid #1e90ff;
            padding-bottom: 5px;
        }
        .sonuc-item {
            background-color: #4b0082; /* Mor renk */
            padding: 3px 8px;
            border-radius: 3px;
            display: inline-block;
            margin: 3px;
            font-size: 14px;
        }

        /* Bahis/Oyun TutarÄ± ve Oyna Butonu */
        .bahis-kontrol, .oyun-butonlari {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .bahis-butonlari {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
        }
        .bahis-butonlari button {
            background-color: #333;
            color: #fff;
            padding: 10px 0;
            border: 1px solid #666;
            border-radius: 5px;
            cursor: pointer;
        }
        .bahis-secim {
            display: flex;
            gap: 5px;
        }
        .bahis-secim button {
            flex-grow: 1;
            padding: 10px 0;
            font-size: 16px;
            background-color: #1e3d6d;
            border: 1px solid #1e90ff;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }

        #oynaToplaBtn {
            background-color: #00cc66; 
            color: white;
            padding: 20px;
            border: none;
            border-radius: 8px;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px #00994d;
            transition: all 0.1s ease;
        }
        #oynaToplaBtn:active {
            box-shadow: 0 2px #00994d;
            transform: translateY(3px);
        }
        /* Topla modundayken rengi deÄŸiÅŸtir */
        #oynaToplaBtn.topla-modu {
            background-color: #ffaa00; /* Turuncu */
            box-shadow: 0 5px #cc8800;
        }
        #oynaToplaBtn.topla-modu:active {
            box-shadow: 0 2px #cc8800;
        }

        .oto-strateji {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        #otoStratejiSwitch {
            width: 60px;
            height: 30px;
            background-color: #333;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: background-color 0.4s;
        }
        #otoStratejiSwitch.on {
            background-color: #1e90ff;
        }
        #otoStratejiSwitch .slider {
            width: 26px;
            height: 26px;
            background-color: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.4s;
        }
        #otoStratejiSwitch.on .slider {
            transform: translateX(30px);
        }
        .not {
            grid-column: 1 / span 3;
            font-size: 12px;
            color: #aaa;
            text-align: center;
            margin-top: 10px;
        }
        /* CSS BitiÅŸi */
    </style>
</head>
<body>

<div class="oyun-container">

    <div class="header">
        <div class="title">ðŸš€ KAZANDIRAN FÄ°NANSÃ‡I</div>
        <div class="bakiye" id="bakiyeGosterge">â‚º100.00</div>
    </div>

    <div class="grafik-alani">
        <div class="carpan-gosterge" id="carpanGosterge">1.00x</div>
        <canvas id="grafikCanvas" width="760" height="350"></canvas>
    </div>

    <div class="hiz-ayarlari">
        <span style="font-weight: bold;">HIZ:</span>
        <button data-speed="200">0.25x</button>
        <button data-speed="100">0.50x</button>
        <button class="aktif" data-speed="50">1.00x</button>
        <button data-speed="33">1.50x</button>
        <button data-speed="25">2.00x</button>
    </div>

    <div class="kontrol-paneli">
        <div class="sonuclar-alani" id="sonuclarAlani">
            <h3>SON EN Ä°YÄ° SONUÃ‡LAR</h3>
        </div>

        <div class="bahis-kontrol">
            <div class="bahis-secim">
                <button onclick="ayarlaBahis(-10)">-</button>
                <button style="flex-grow: 2;" id="aktifBahisGosterge">â‚º10.00</button>
                <button onclick="ayarlaBahis(10)">+</button>
            </div>

            <div class="bahis-butonlari">
                <button onclick="setBahis(10)">â‚º10,00</button>
                <button onclick="setBahis(20)">â‚º20,00</button>
                <button onclick="setBahis(30)">â‚º30,00</button>
                <button onclick="setBahis(50)">â‚º50,00</button>
            </div>

            <button style="background-color: #1e3d6d; padding: 10px;">OTO STRATEJÄ° YAP</button>
        </div>

        <div class="oyun-butonlari">
            <button id="oynaToplaBtn" onclick="oynaVeyaTopla()">OYNA</button>

            <div class="oto-strateji">
                <div id="otoStratejiSwitch" class="on">
                    <div class="slider"></div>
                </div>
                <span>OTO STRATEJÄ°</span>
            </div>
        </div>

        <div class="not">
            Tur baÅŸladÄ±ktan sonra dahil olunan oyunlar, kazanÃ§larda %32 kesintiye tabidir.
        </div>
    </div>

</div>

<script>
    // JavaScript BaÅŸlangÄ±cÄ± - GerÃ§ekÃ§i Crash Oyunu Modeli

    const bakiyeGosterge = document.getElementById('bakiyeGosterge');
    const aktifBahisGosterge = document.getElementById('aktifBahisGosterge');
    const oynaToplaBtn = document.getElementById('oynaToplaBtn');
    const carpanGosterge = document.getElementById('carpanGosterge');
    const sonuclarAlani = document.getElementById('sonuclarAlani');
    const canvas = document.getElementById('grafikCanvas');
    const ctx = canvas.getContext('2d');

    let bakiye = 100.00;
    let aktifBahis = 10.00;
    let oyunBasladi = false;
    let mevcutCarpan = 1.00;
    let oyunHiziMs = 50; 
    let oyunInterval;
    let grafikNoktalari = []; 
    let grafikKapasitesi = 100;

    const CANVAS_HEIGHT = 350;
    const CANVAS_WIDTH = 760;
    const MAX_GOSTERIM = 50.0; // Grafik Ã§izimi iÃ§in Max.
    const MAX_KAZANC = 10000000.00; 
    const TARGET_RTP = 0.70; 
    // Lambda (HÄ±z parametresi) Inverse Exponential Distribution iÃ§in: Lambda = 1 / RTP
    const LAMBDA = 1 / TARGET_RTP; 

    let crashNoktasi = 0.01; // Her tur baÅŸÄ±nda rastgele belirlenecek hedef Ã§arpan

    // --- UI ve Bahis YÃ¶netimi ---
    function updateUI() {
        bakiyeGosterge.textContent = `â‚º${bakiye.toFixed(2)}`;
        aktifBahisGosterge.textContent = `â‚º${aktifBahis.toFixed(2)}`;
    }

    function setBahis(tutar) {
        if (oyunBasladi) return;
        aktifBahis = Math.max(10.00, Math.min(100.00, tutar));
        updateUI();
    }

    function ayarlaBahis(delta) {
        if (oyunBasladi) return;
        let yeniBahis = aktifBahis + delta;
        yeniBahis = Math.max(10.00, Math.min(100.00, yeniBahis));
        setBahis(yeniBahis);
    }
    
    // --- Grafik Ã‡izimi Fonksiyonu ---
    function cizGrafik() {
        ctx.clearRect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);

        if (grafikNoktalari.length < 2) return;

        ctx.beginPath();
        ctx.strokeStyle = carpanGosterge.style.color; 
        ctx.lineWidth = 3;

        const noktaSayisi = grafikNoktalari.length;
        const cizilecekNoktalar = grafikNoktalari.slice(Math.max(0, noktaSayisi - grafikKapasitesi));
        const xStep = CANVAS_WIDTH / (grafikKapasitesi - 1 || 1); 

        const y_min = CANVAS_HEIGHT * 0.02; 
        const y_max = CANVAS_HEIGHT * 0.98; 

        cizilecekNoktalar.forEach((carpan, index) => {
            const x = index * xStep;
            
            const normalizedCarpan = Math.max(0.00, Math.min(MAX_GOSTERIM, carpan));
            
            const oran = normalizedCarpan / MAX_GOSTERIM;
            
            const y = y_max - (y_max - y_min) * oran;

            if (index === 0) {
                ctx.moveTo(x, y);
            } else {
                ctx.lineTo(x, y);
            }
        });

        ctx.stroke();
    }

    // --- Oyun MantÄ±ÄŸÄ± ---

    // RTP'ye uygun, matematiksel olarak adil bir Crash NoktasÄ± Ã¼retir.
    function generateCrashPoint() {
        // Inverse Exponential Distribution formÃ¼lÃ¼: x = 1 / (lambda * (1 - r))
        // Bu, crash oyunlarÄ±nÄ±n RTP matematiÄŸinin temelidir.
        const r = Math.random(); 
        let crashPoint = 1 + (Math.log(LAMBDA) - Math.log(LAMBDA - 1)) / LAMBDA; 
        
        // BasitleÅŸtirilmiÅŸ formÃ¼l: x = 1 / (1 - r)^(1/LAMBDA) 
        // Crash oyunlarÄ±nda kullanÄ±lan genel formÃ¼lÃ¼n tersi: x = 1 / (1 - r) * (1 - 1/LAMBDA)
        
        // GerÃ§ekÃ§i Crash oyunu daÄŸÄ±lÄ±mÄ±: x = 1 / (1 - r)^(1/LAMBDA)
        // Ancak bu, basit JS simÃ¼lasyonlarÄ±nda yavaÅŸ kalÄ±r. En kolayÄ±:
        // C = LAMBDA / (LAMBDA - 1) 
        // x = 1 / (1 - (r * (1 - 1/C))) 

        // En basit Crash formÃ¼lÃ¼ (LAMBDA > 1 varsayÄ±mÄ± ile):
        crashPoint = 1 / (1 - Math.pow(r, 1 / LAMBDA)); 

        // EÄŸer crashPoint Ã§ok kÃ¼Ã§Ã¼kse (teoride 1.00x bile olabilir), en az 1.01x yapsÄ±n
        crashPoint = Math.max(1.01, crashPoint);
        
        // Teorik max Ã§arpanÄ± sÄ±nÄ±rla (eÄŸer 100x'i Ã§ok aÅŸarsa)
        return parseFloat(Math.min(100000.00, crashPoint).toFixed(2)); 
    }

    // Sabit BÃ¼yÃ¼me HÄ±zÄ±
    function calculateNextCarpan() {
        // Her 50ms (1.00x hÄ±zda) iÃ§in artÄ±ÅŸ adÄ±mÄ±.
        // 1.00x'ten 2.00x'e ulaÅŸmasÄ± iÃ§in 200 adÄ±ma (10 saniyeye) yakÄ±n sÃ¼re gerekir.
        const artimHizi = 0.005; 
        let nextCarpan = mevcutCarpan + artimHizi;
        
        return parseFloat(nextCarpan.toFixed(2));
    }


    function turuBaslat() {
        if (bakiye < aktifBahis) {
            alert("Yetersiz bakiye!");
            return;
        }

        bakiye -= aktifBahis; 
        updateUI();

        // **TUR BAÅžINDA GÄ°ZLÄ° CRASH NOKTASINI BELÄ°RLE**
        crashNoktasi = generateCrashPoint();
        
        oyunBasladi = true;
        mevcutCarpan = 1.00;
        grafikNoktalari = [1.00];
        oynaToplaBtn.textContent = 'TOPLA';
        oynaToplaBtn.classList.add('topla-modu');
        carpanGosterge.textContent = mevcutCarpan.toFixed(2) + 'x';
        carpanGosterge.classList.remove('crash'); 
        carpanGosterge.style.color = '#00ff7f'; 
        
        turuCalistir();
    }

    function turuCalistir() {
        oyunInterval = setInterval(() => {
            if (!oyunBasladi) {
                clearInterval(oyunInterval);
                return;
            }

            mevcutCarpan = calculateNextCarpan();

            // 1. Crash KontrolÃ¼: Gizli noktaya ulaÅŸtÄ±k mÄ±?
            if (mevcutCarpan >= crashNoktasi) {
                mevcutCarpan = 0.01; // AnÄ±nda Ã§Ã¶kÃ¼ÅŸ gÃ¶rseli iÃ§in
                grafikNoktalari.push(mevcutCarpan); 
                turuBitir(false); // KayÄ±p
                return;
            }

            // 2. Maksimum KazanÃ§ KontrolÃ¼
            if (aktifBahis * mevcutCarpan > MAX_KAZANC) {
                 mevcutCarpan = MAX_KAZANC / aktifBahis; 
            }
            
            // UI ve Renk GÃ¼ncellemesi
            carpanGosterge.textContent = mevcutCarpan.toFixed(2) + 'x';
            carpanGosterge.style.color = mevcutCarpan >= 1.00 ? '#00ff7f' : '#ffaa00'; 
            
            grafikNoktalari.push(mevcutCarpan);
            cizGrafik();
        }, oyunHiziMs);
    }

    function turuBitir(kazanildi) {
        clearInterval(oyunInterval);
        oyunBasladi = false;
        oynaToplaBtn.textContent = 'OYNA';
        oynaToplaBtn.classList.remove('topla-modu');
        
        let sonucMetni;
        
        if (kazanildi) {
            const gercekKazanc = aktifBahis * mevcutCarpan;
            const nihaiKazanc = Math.min(gercekKazanc, MAX_KAZANC);
            const odenenKazanc = nihaiKazanc * 0.68; 

            bakiye += odenenKazanc;
            sonucMetni = `${mevcutCarpan.toFixed(2)}x (KAZANÃ‡: â‚º${odenenKazanc.toFixed(2)})`;
            carpanGosterge.classList.remove('crash');
            carpanGosterge.style.color = '#00ff7f';
        } else {
            // KayÄ±p anÄ± (mevcutCarpan 0.01 olarak ayarlandÄ±)
            sonucMetni = `0.01x (CRASH! Ortalama: ${crashNoktasi.toFixed(2)}x)`;
            carpanGosterge.textContent = "0.01x";
            carpanGosterge.classList.add('crash'); 
            carpanGosterge.style.color = '#ff4d4d'; 
            
            // Yatay seyir simÃ¼lasyonu
            for(let i=0; i<5; i++) {
                grafikNoktalari.push(0.01);
            }
            cizGrafik(); 
        }
        
        ekleSonuc(sonucMetni, kazanildi);
        updateUI();
    }

    function ekleSonuc(sonuc, kazanildi) {
        const yeniSonucDiv = document.createElement('div');
        yeniSonucDiv.classList.add('sonuc-item');
        yeniSonucDiv.textContent = sonuc;
        if (!kazanildi) {
             yeniSonucDiv.style.backgroundColor = '#660000'; 
        } else {
             yeniSonucDiv.style.backgroundColor = '#4b0082'; 
        }

        sonuclarAlani.insertBefore(yeniSonucDiv, sonuclarAlani.children[1]); 
        
        while (sonuclarAlani.children.length > 21) {
            sonuclarAlani.removeChild(sonuclarAlani.lastChild);
        }
    }

    function oynaVeyaTopla() {
        if (oyunBasladi) {
            if (mevcutCarpan > 1.00) {
                turuBitir(true); 
            } else {
                alert("Toplamak iÃ§in Ã§arpanÄ±n 1.00x'i geÃ§mesi gerekir.");
            }
        } else {
            turuBaslat();
        }
    }

    // --- Olay Dinleyicileri ---
    
    document.querySelectorAll('.hiz-ayarlari button').forEach(button => {
        button.addEventListener('click', function() {
            if (oyunBasladi) return;
            
            document.querySelector('.hiz-ayarlari .aktif').classList.remove('aktif');
            this.classList.add('aktif');
            oyunHiziMs = parseInt(this.dataset.speed);
        });
    });

    document.getElementById('otoStratejiSwitch').addEventListener('click', function() {
        this.classList.toggle('on');
    });

    window.onload = () => {
        updateUI();
        const grafikAlani = document.querySelector('.grafik-alani');
        canvas.width = grafikAlani.clientWidth - 4; 
        canvas.height = grafikAlani.clientHeight - 4;
        cizGrafik();
    };
    
    // JavaScript BitiÅŸi
</script>

</body>
</html>
